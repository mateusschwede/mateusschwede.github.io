<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="shortcut icon" href="../anexos/icons/logoCircle64.png"/>
    <link rel="stylesheet" href="../estilo.css">
    <title>Mateus Notes</title>
</head>
<body>
<div class="container-fluid">


    <div class="row">
        <div class="col-sm-12" id="menu">
            <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-light">
                <a class="navbar-brand" href="../index.html"><svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0 0 172 172" style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="none" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,172v-172h172v172z" fill="none" stroke="none" stroke-linecap="butt"></path><g><path d="M26.875,102.125h8.6" fill="none" stroke="#dbb065" stroke-linecap="square"></path><path d="M26.875,82.775l8.6,4.3" fill="none" stroke="#dbb065" stroke-linecap="square"></path><path d="M31.175,121.475l8.6,-6.45" fill="none" stroke="#dbb065" stroke-linecap="square"></path><path d="M145.125,102.125h-8.6" fill="none" stroke="#dbb065" stroke-linecap="square"></path><path d="M145.125,82.775l-8.6,4.3" fill="none" stroke="#dbb065" stroke-linecap="square"></path><path d="M140.825,121.475l-8.6,-6.45" fill="none" stroke="#dbb065" stroke-linecap="square"></path><rect x="35.5" y="67.5" transform="scale(2.15,2.15)" width="9" height="10.5" fill="#5f4000" stroke="none" stroke-linecap="butt"></rect><path d="M115.025,134.375h-58.05l-13.975,-67.725h86z" fill="#ffeea3" stroke="none" stroke-linecap="butt"></path><path d="M121.475,140.825v-6.45h-70.95v6.45h6.45l12.9,12.9h32.25l12.9,-12.9z" fill="#5f4000" stroke="#000000" stroke-linecap="butt"></path><path d="M136.525,59.125v6.45h-101.05v-6.45h6.45l32.25,-21.5h23.65l32.25,21.5z" fill="#5f4000" stroke="#000000" stroke-linecap="butt"></path><rect x="38.5" y="12.5" transform="scale(2.15,2.15)" width="3" height="5" fill="#5f4000" stroke="#000000" stroke-linecap="butt"></rect><path d="M95.675,19.35c0,5.34275 -4.33225,9.675 -9.675,9.675c-5.34275,0 -9.675,-4.33225 -9.675,-9.675c0,-5.34275 9.675,-15.05 9.675,-15.05c0,0 9.675,9.70725 9.675,15.05z" fill="#5f4000" stroke="#000000" stroke-linecap="butt"></path><path d="M76.325,166.625v-12.9" fill="none" stroke="#000000" stroke-linecap="square"></path><path d="M95.675,166.625v-12.9" fill="none" stroke="#000000" stroke-linecap="square"></path><path d="M56.975,134.375l-15.05,-68.8" fill="none" stroke="#000000" stroke-linecap="butt"></path><path d="M115.025,134.375l15.05,-68.8" fill="none" stroke="#000000" stroke-linecap="butt"></path><rect x="38.5" y="30.5" transform="scale(2.15,2.15)" width="3" height="32" fill="#5f4000" stroke="#000000" stroke-linecap="butt"></rect></g></g></svg> MateusNotes</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav">
                        <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="../contato.html">Contato</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-12" id="titulo1">
            <h1>Php7 PDO OOP</h1>
            <h6><strong>Sintaxe Php7 PDO OOP</strong></h6>
        </div>

        <div class="col-sm-12">
            <h4>Resumo</h4>
<small><pre><code>
-- COM 1 CLASSE --

//Banco modelo:
CREATE DATABASE aula16;
USE aula16;
CREATE TABLE Pessoa (
    id INTEGER AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(20) NOT NULL,
    sobrenome VARCHAR(20) NOT NULL
);
INSERT INTO Pessoa (nome,sobrenome) VALUES ('Carlos','Garcia'),('Maria','Antunes'),('Cassio','Silva'),('Marcela','Moraes');

//Classe Pessoa.class.php
&lt?php
    class Pessoa {
        private $id;
        private $nome;
        private $sobrenome;

        public function info() {
            $r = '#'.$this->id;
            $r .= ':'.$this->nome;
            $r .= ' '.$this->sobrenome;
            return $r;
        }
    }
?&gt
O nome dos atributos da classe deve coincidir com o nome dos campos da tabela!

&lt?php
    $db = new PDO('mysql:host=localhost;dbname=aula16;charset=utf8','root','');
    $query = "SELECT id, nome, sobrenome FROM Pessoa";
    $r = $db->query($query);
    $r->setFetchMode(PDO::FETCH_CLASS,'Pessoa');
    while($pessoa = $r->fetch()) {echo $pessoa->info()."&ltbr&gt\n";}
?&gt


-- COM 2 CLASSES --

//Banco modelo:
create database aula18;
use aula18;
create table equipe (
    id integer not null primary key,
    nome varchar(30) not null,
    cidade varchar(30) not null
);
create table atleta (
    id integer not null primary key,
    nome varchar(30) not null,
    sobrenome varchar(30) not null,
    posicao varchar(30) not null,
    equipe_id integer not null,
    constraint equipe_fk foreign key (equipe_id) references equipe(id)
);

//Classe Equipe.class.php
&lt?php
    class Equipe {
        private $id, $nome, $cidade, $atletas;
        public function getId() {return $this->id;}
        public function getNome() {return $this->nome;}
        public function getCidade() {return $this->cidade;}
        public function getAtletas() {return $this->atletas;}
        public function addAtleta(Atleta $atleta) {$this->atletas[] = $atleta;}
    }
?&gt
//$atletas: Atributo array para manter com a tabela 'atletas'

//Classe Atleta.class.php
&lt?php
    class Atleta {
        private $id, $nome, $sobrenome, $posicao, $equipe_id;
        public function getId() {return $this ->id;}
        public function getNome() {return $this ->nome;}
        public function getSobrenome() {return $this ->sobrenome;}
        public function getPosicao() {return $this ->posicao;}
        public function getEquipeID() {return $this ->equipe_id;}
    }
?&gt

//index.php
&lt?php
    $equipes = array();
    $db = new PDO('mysql:host=localhost;dbname=aula18','root','');
    $select1 = 'SELECT id, nome, cidade FROM Equipe';
    $r1 = $db->query($select1);
    $r1->setFetchMode(PDO::FETCH_CLASS,'Equipe');
    $select2 = 'SELECT id, nome, sobrenome, posicao FROM Atleta WHERE equipe_id = :id';
    $r2 = $db->prepare($select2);
    while ($equipe = $r1->fetch()) {
        $r2->bindValue(':id',$equipe->getId(),PDO::PARAM_INT);
        $r2->execute();
        $r2->setFetchMode(PDO::FETCH_CLASS,'Atleta');
        while ($atleta = $r2->fetch()) {$equipe->addAtleta($atleta);}
        $equipes[] = $equipe;
    }
?&gt
</code></pre></small>
        </div>
    </div>


</div>
</body>
</html>